#!/bin/bash

set -o errexit

#javaDir="/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Commands"
javaDir="/usr/bin"

currentDir=$(pwd)
buildDir=/tmp/mlflexlite_build

rm -rfv $buildDir

mkdir -pv $buildDir/mlflexlite/src/mlflexlite
cp -rv mlflexlite/src/mlflexlite/* $buildDir/mlflexlite/src/mlflexlite
cp -v build.xml $buildDir/

cd $buildDir

find mlflexlite -name *.java > sources_list.txt
$javaDir/javac @sources_list.txt
rm sources_list.txt

ant

mkdir -p $currentDir/release
rm -rf $currentDir/release/*

cp -v mlflexlite.jar $currentDir/release/

cd $currentDir
rm -rf $buildDir
